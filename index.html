<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Haber Robotu – Otomatik Güncel Haberler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google AdSense site doğrulama -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6477894031302669"
       crossorigin="anonymous"></script>

  <style>
    :root {
      --bg: #0f172a;
      --bg-card: #020617;
      --bg-alt: #020617;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #facc15;
      --accent-soft: rgba(250, 204, 21, 0.12);
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
    }
    .shell {
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px 12px 48px;
    }
    header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 18px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(15,23,42,0.95), rgba(15,23,42,0.98));
      border: 1px solid rgba(148,163,184,0.18);
      box-shadow: 0 24px 80px rgba(0,0,0,0.55);
      position: sticky;
      top: 8px;
      z-index: 20;
      backdrop-filter: blur(16px);
      flex-wrap: wrap;
    }
    .logo {
      width: 38px;
      height: 38px;
      border-radius: 12px;
      background: radial-gradient(circle at 20% 0%, #facc15, #f97316);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #020617;
      font-weight: 900;
      font-size: 18px;
      box-shadow: 0 0 0 2px rgba(15,23,42,0.9), 0 16px 45px rgba(250,204,21,0.45);
    }
    .title-wrap { flex: 1 1 200px; }
    .title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: .02em;
    }
    .subtitle {
      font-size: 13px;
      color: var(--muted);
    }
    .pill {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.35);
      color: var(--muted);
      background: rgba(15,23,42,0.9);
      white-space: nowrap;
    }
    .top-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 13px;
      margin-top: 6px;
    }
    .top-nav a {
      color: #facc15;
      text-decoration: none;
    }

    .toolbar {
      margin-top: 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
    }
    .filters { display: flex; flex-wrap: wrap; gap: 8px; }
    .btn-filter {
      border-radius: 999px;
      font-size: 13px;
      padding: 5px 12px;
      border: 1px solid var(--border);
      background: rgba(15,23,42,0.9);
      color: var(--muted);
      cursor: pointer;
      transition: all .15s ease;
    }
    .btn-filter.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: #fefce8;
    }
    .status {
      font-size: 12px;
      color: var(--muted);
    }

    /* Orta alan reklamları */
    .ad {
      margin: 16px 0 12px;
      padding: 10px;
      border-radius: 12px;
      border: 1px dashed rgba(148,163,184,0.55);
      background: rgba(15,23,42,0.85);
      font-size: 12px;
      color: var(--muted);
      text-align: center;
    }
    .ad span {
      display: block;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 2px;
    }

    /* Yan (sidebar) reklam alanları */
    .side-ad {
      position: fixed;
      top: 70px;
      width: 260px;
      height: calc(100vh - 100px);
      border-radius: 14px;
      border: 1px dashed rgba(148,163,184,0.55);
      background: rgba(15,23,42,0.92);
      color: var(--muted);
      font-size: 11px;
      padding: 10px;
      display: none;
      z-index: 15;
      text-align: center;
      overflow: hidden;
    }
    .side-ad span {
      display: block;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 4px;
    }
    .side-ad-left { left: 12px; }
    .side-ad-right { right: 12px; }

    /* Liste */
    .grid {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .card {
      display: grid;
      grid-template-columns: 200px minmax(0,1fr);
      gap: 14px;
      padding: 12px;
      border-radius: 14px;
      background: rgba(15,23,42,0.96);
      border: 1px solid rgba(31,41,55,0.9);
      box-shadow: 0 14px 40px rgba(0,0,0,0.65);
    }
    .thumb-wrap {
      border-radius: 10px;
      overflow: hidden;
      background: radial-gradient(circle at 10% 0%, #1f2937, #020617);
      border: 1px solid rgba(31,41,55,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--muted);
      text-align: center;
      padding: 6px;
    }
    .thumb-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .card-body {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .meta-line {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
    }
    .badge-source {
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(55,65,81,0.9);
      background: rgba(15,23,42,0.9);
    }
    .badge-tag {
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(34,197,94,0.08);
      border: 1px solid rgba(34,197,94,0.25);
      color: #bbf7d0;
    }
    .badge-cat {
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(59,130,246,0.12);
      border: 1px solid rgba(59,130,246,0.35);
      color: #bfdbfe;
    }
    .headline {
      font-size: 16px;
      font-weight: 600;
      color: #f9fafb;
      margin: 2px 0;
    }
    .summary {
      font-size: 13px;
      color: #d1d5db;
    }
    .actions {
      margin-top: 6px;
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }
    .btn-read {
      font-size: 12px;
      padding: 5px 11px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: var(--accent);
      color: #1f2937;
      font-weight: 600;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .btn-read:hover {
      filter: brightness(1.08);
    }
    .source-url {
      font-size: 11px;
      color: var(--muted);
      max-width: 220px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    footer {
      margin-top: 26px;
      font-size: 11px;
      color: var(--muted);
      text-align: center;
    }

    /* Mobil ve orta ekran ayarları */
    @media (max-width: 768px) {
      header { flex-direction: column; align-items: flex-start; }
      .title { font-size: 18px; }
      .subtitle { font-size: 12px; }
      .card { grid-template-columns: 1fr; }
      .thumb-wrap { height: 190px; }
    }

    /* Geniş ekranlarda yan reklamları göster ve içerik genişliğini daralt */
    @media (min-width: 1400px) {
      .shell {
        max-width: 900px;
      }
      .side-ad {
        display: block;
      }
    }
  </style>
</head>
<body>
  <!-- SOL YAN REKLAM -->
  <div class="side-ad side-ad-left">
    <span>Sol Kenar Reklam Alanı</span>
    Buraya 160x600 / 300x600 AdSense skyscraper kodunu ekleyebilirsin.
  </div>

  <!-- SAĞ YAN REKLAM -->
  <div class="side-ad side-ad-right">
    <span>Sağ Kenar Reklam Alanı</span>
    Buraya ikinci skyscraper veya sabit sponsor logo yerleştirebilirsin.
  </div>

  <div class="shell">
    <header>
      <div class="logo">HR</div>
      <div class="title-wrap">
        <div class="title">Haber Robotu</div>
        <div class="subtitle">Türkiye ve dünyadan haberler, her saat otomatik güncellenir.</div>
        <div class="top-nav">
          <a href="about.html">Hakkında</a>
          <a href="privacy.html">Gizlilik Politikası</a>
          <a href="terms.html">Kullanım Şartları</a>
          <a href="contact.html">İletişim</a>
        </div>
      </div>
      <div class="pill">Canlı otomatik haber akışı</div>
    </header>

    <!-- Kaynak filtreleri -->
    <div class="toolbar">
      <div class="filters">
        <button class="btn-filter btn-filter-source active" data-filter-source="all">Tüm Kaynaklar</button>
        <button class="btn-filter btn-filter-source" data-filter-source="tr">Türkiye Kaynaklı</button>
        <button class="btn-filter btn-filter-source" data-filter-source="intl">Yabancı Kaynaklı</button>
      </div>
      <div class="status" id="status">Haberler yükleniyor...</div>
    </div>

    <!-- Kategori filtreleri -->
    <div class="toolbar" style="margin-top:8px;">
      <div class="filters">
        <button class="btn-filter btn-filter-cat active" data-filter-cat="all">Tüm Kategoriler</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="gundem">Gündem</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="dunya">Dünya</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="spor">Spor</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="teknoloji">Teknoloji</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="saglik">Sağlık</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="ekonomi">Ekonomi</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="magazin">Magazin</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="bilim">Bilim</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="savunma">Savunma / Askeri</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="oyun">Oyun / Dijital</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="otomobil">Otomobil</button>
        <button class="btn-filter btn-filter-cat" data-filter-cat="yasam">Yaşam</button>
      </div>
    </div>

    <!-- ÜST BANNER REKLAM ALANI -->
    <div class="ad">
      <span>Üst Banner Reklam Alanı – 728x90</span>
      Google AdSense kodunu bu kutunun içine yerleştireceksin.
    </div>

    <div class="grid" id="haberler"></div>

    <!-- ALT REKLAM ALANI -->
    <div class="ad">
      <span>Alt Banner / Native Reklam Alanı</span>
      Sponsorlu içerik veya ikinci AdSense birimi için ideal alan.
    </div>

    <footer>
      İçerikler ilgili haber sitelerinden otomatik olarak derlenir. Başlık ve özetler bilgilendirme amaçlıdır,
      detaylar için her haberdeki “Haberi Oku” butonuna tıklayarak kaynağa gidebilirsiniz.
    </footer>
  </div>

  <script>
    let ALL_ARTICLES = [];
    let CURRENT_SOURCE_FILTER = "all";
    let CURRENT_CATEGORY_FILTER = "all";

    const CATEGORY_LABELS = {
      gundem: "Gündem",
      dunya: "Dünya",
      spor: "Spor",
      teknoloji: "Teknoloji",
      saglik: "Sağlık",
      ekonomi: "Ekonomi",
      magazin: "Magazin",
      bilim: "Bilim",
      savunma: "Savunma / Askeri",
      oyun: "Oyun / Dijital",
      otomobil: "Otomobil",
      yasam: "Yaşam"
    };

    function getDomain(url) {
      try {
        const u = new URL(url);
        return u.hostname.replace(/^www\./, "");
      } catch {
        return "";
      }
    }

    function classifySource(url) {
      const d = getDomain(url);
      if (!d) return { label: "Bilinmeyen", type: "intl" };
      const isTr = d.endsWith(".tr");
      return {
        label: d,
        type: isTr ? "tr" : "intl"
      };
    }

    function classifyCategory(article) {
      const text = ((article.title || "") + " " + (article.summary || "")).toLowerCase();
      const src = classifySource(article.url);

      const has = (keywords) => keywords.some(k => text.includes(k));

      // Spor
      if (has(["spor","maç","mac ","futbol","basketbol","voleybol","lig ","şampiyona","gol ","transfer","hakem","tenis","nba","fifa","uefa","olimpiyat"])) {
        return "spor";
      }
      // Teknoloji
      if (has(["teknoloji","uygulama","yazılım","telefon","akıllı","android","ios","yapay zeka","ai ","robot","çip","işlemci","apple","samsung","google","microsoft","uzay","roket","uydu"])) {
        return "teknoloji";
      }
      // Sağlık
      if (has(["sağlık","hastane","doktor","virüs","enfeksiyon","kanser","tedavi","ilaç","aşı","koronavirüs","covid","grip","diyet","obezite"])) {
        return "saglik";
      }
      // Ekonomi
      if (has(["ekonomi","dolar","euro","altın","borsa","faiz","enflasyon","piyasa","kriz","ihracat","ithalat","yatırım","gelir","vergi","asgari ücret","memur maaşı"])) {
        return "ekonomi";
      }
      // Magazin
      if (has(["magazin","ünlü","şarkıcı","oyuncu","dizi","film","evlilik","boşanma","aşk","görüntülendi","ünlü isim","defile","manken","klip"])) {
        return "magazin";
      }
      // Bilim
      if (has(["bilim","araştırma","deney","bilim insanı","laboratuvar","keşif","evren","fizik","kimya","biyoloji","genetik","astronomi"])) {
        return "bilim";
      }
      // Savunma / Askeri
      if (has(["savunma","ordu","asker","tatbikat","füze","tank","savaş uçağı","hava kuvvetleri","deniz kuvvetleri","operasyon","saldırı","terör","nato","güvenlik güçleri"])) {
        return "savunma";
      }
            // Oyun / Dijital
      if (has([
        "oyun","oyuncu","oyunculuk ","video oyunu","bilgisayar oyunu","playstation","ps4","ps5", "xbox","nintendo","switch","steam","epic games","battle.net","mobil oyun","android oyun","ios oyun", "battle royale","espor","e-spor", "gamer","gaming","call of duty","pubg","fortnite","valorant","cs2","counter strike","league of legends","lol ","dota","gta","fifa","efootball"
      ])) {
        return "oyun";
      }
      // Otomobil
      if (has(["otomobil","araba","araç","otomotiv","tesla","bmw","mercedes","renault","hyundai","trafik kazası","sürücü","otoyol","togg"])) {
        return "otomobil";
      }
      // Yaşam
      if (has(["yaşam","hayat","aile","evlilik","çocuk","alışveriş","tatil","seyahat","gezi","yemek","tarif","kültür","sanat","festival","etkinlik"])) {
        return "yasam";
      }

      // Hiçbiri değilse, kaynağa göre Gündem / Dünya
      if (src.type === "intl") return "dunya";
      return "gundem";
    }

    function renderArticles() {
      const container = document.getElementById("haberler");
      container.innerHTML = "";

      const list = ALL_ARTICLES.filter(a => {
        const src = classifySource(a.url);
        if (CURRENT_SOURCE_FILTER === "tr" && src.type !== "tr") return false;
        if (CURRENT_SOURCE_FILTER === "intl" && src.type !== "intl") return false;

        const cat = classifyCategory(a);
        if (CURRENT_CATEGORY_FILTER !== "all" && cat !== CURRENT_CATEGORY_FILTER) return false;

        return true;
      });

      list.forEach((a, index) => {
        if (index > 0 && index % 6 === 0) {
          const ad = document.createElement("div");
          ad.className = "ad";
          ad.innerHTML = "<span>Akış İçi Reklam Alanı</span>Bu satır Google AdSense in-feed reklam birimi için ayrıldı.";
          container.appendChild(ad);
        }

        const src = classifySource(a.url);
        const catKey = classifyCategory(a);
        const catLabel = CATEGORY_LABELS[catKey] || "Gündem";

        const card = document.createElement("article");
        card.className = "card";

        const imgHtml = a.image
          ? `<img src="${a.image}" alt="" loading="lazy" onerror="this.style.display='none'">`
          : `<div>Görsel bulunamadı</div>`;

        card.innerHTML = `
          <div class="thumb-wrap">
            ${imgHtml}
          </div>
          <div class="card-body">
            <div class="meta-line">
              <span class="badge-source">${src.label}</span>
              <span class="badge-tag">${src.type === "tr" ? "Türkiye kaynağı" : "Uluslararası kaynak"}</span>
              <span class="badge-cat">${catLabel}</span>
            </div>
            <h2 class="headline">${a.title || "Başlık yok"}</h2>
            <p class="summary">${a.summary || ""}</p>
            <div class="actions">
              <a class="btn-read" href="${a.url}" target="_blank" rel="noopener noreferrer">
                Haberi Oku
              </a>
              <span class="source-url">${a.url}</span>
            </div>
          </div>
        `;
        container.appendChild(card);
      });

      if (list.length === 0) {
        container.innerHTML = "<p style='color:#9ca3af;font-size:13px;'>Bu filtreler için gösterilecek haber bulunamadı.</p>";
      }
    }

    async function loadNews() {
      const status = document.getElementById("status");
      try {
        const res = await fetch("./news/latest.json?t=" + Date.now());
        if (!res.ok) {
          status.textContent = "news/latest.json yüklenemedi (HTTP " + res.status + ")";
          return;
        }
        const data = await res.json();
        ALL_ARTICLES = data.articles || [];
        status.textContent = "Toplam " + ALL_ARTICLES.length + " haber yüklendi • generated_at: " + (data.generated_at || "");
        renderArticles();
      } catch (err) {
        console.error(err);
        status.textContent = "Haber yüklenirken hata oluştu: " + err;
      }
    }

    document.addEventListener("click", function (e) {
      const srcBtn = e.target.closest(".btn-filter-source");
      if (srcBtn) {
        document.querySelectorAll(".btn-filter-source").forEach(b => b.classList.remove("active"));
        srcBtn.classList.add("active");
        CURRENT_SOURCE_FILTER = srcBtn.getAttribute("data-filter-source") || "all";
        renderArticles();
        return;
      }
      const catBtn = e.target.closest(".btn-filter-cat");
      if (catBtn) {
        document.querySelectorAll(".btn-filter-cat").forEach(b => b.classList.remove("active"));
        catBtn.classList.add("active");
        CURRENT_CATEGORY_FILTER = catBtn.getAttribute("data-filter-cat") || "all";
        renderArticles();
      }
    });

    loadNews();
  </script>
</body>
</html>
