<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Haber Robotu</title>
  <meta name="description" content="CanlÄ± otomatik haber akÄ±ÅŸÄ±. TÃ¼rkiye ve dÃ¼nyadan Ã¶nemli haberler." />
  <meta name="theme-color" content="#0b1220" />

  <!--
    BURAYA (varsa) Google AdSense / doÄŸrulama meta kodlarÄ±nÄ± ekle:
    <meta name="google-site-verification" content="..." />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=..."
            crossorigin="anonymous"></script>
  -->

  <style>
    :root{
      --bg1:#070b14;
      --bg2:#0b1220;
      --card:#0f1623;
      --card2:#0d1421;
      --border:rgba(255,255,255,.08);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --muted2:rgba(255,255,255,.55);
      --accent:#f5c542;
      --accent2:#ffcc00;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(255,204,0,.12), transparent 60%),
        radial-gradient(1000px 700px at 85% 15%, rgba(100,160,255,.10), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
    }

    .container{max-width:1100px;margin:0 auto;padding:18px 14px 40px}

    /* Topbar */
    .topbar{
      display:flex;align-items:center;gap:14px;
      padding:12px 14px;margin:10px 0 14px;
      border:1px solid var(--border);
      background:rgba(15,22,35,.65);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      box-shadow: var(--shadow);
    }
    .brand{
      display:flex;align-items:center;gap:12px;min-width:220px;
    }
    .logo{
      width:44px;height:44px;border-radius:14px;
      background: linear-gradient(180deg, #ffcc00, #f5b400);
      display:grid;place-items:center;
      color:#111;font-weight:900;letter-spacing:.5px;
      box-shadow: 0 10px 30px rgba(255,204,0,.25);
      border: 1px solid rgba(0,0,0,.08);
      flex:0 0 auto;
    }
    .brand h1{font-size:18px;line-height:1;margin:0}
    .brand .sub{font-size:12px;color:var(--muted);margin-top:2px}

    .searchwrap{
      flex:1;display:flex;align-items:center;gap:10px;
    }
    .search{
      flex:1;
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;
      border-radius: 16px;
      border:1px solid var(--border);
      background: rgba(11,18,32,.6);
    }
    .search input{
      width:100%;
      border:0;outline:0;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .pill{
      padding:9px 12px;border-radius:14px;
      border:1px solid var(--border);
      background: rgba(11,18,32,.55);
      color: var(--muted);
      font-size:13px;
      cursor:pointer;
      user-select:none;
    }
    .pill:hover{background:rgba(255,255,255,.06)}
    .pill.active{
      color:#111;
      background: linear-gradient(180deg, #ffcc00, #f5b400);
      border-color: rgba(255,204,0,.35);
      font-weight:700;
    }

    /* Filters row */
    .filters{
      display:flex;flex-wrap:wrap;gap:10px;
      margin: 10px 0 14px;
    }

    /* Cards */
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media(min-width:900px){
      .grid{grid-template-columns: 1fr 1fr;}
    }

    .card{
      display:flex;gap:14px;
      padding:14px;
      border-radius: var(--radius);
      border:1px solid var(--border);
      background: rgba(15,22,35,.70);
      backdrop-filter: blur(10px);
      box-shadow: 0 12px 40px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .thumb{
      width:110px;height:110px;border-radius:16px;flex:0 0 auto;
      overflow:hidden;border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.06);
      display:grid;place-items:center;
    }
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .thumb .noimg{color:var(--muted2);font-size:12px;text-align:center;padding:10px}

    .cardbody{min-width:0;flex:1;display:flex;flex-direction:column;gap:8px}
    .meta{
      display:flex;align-items:center;gap:8px;flex-wrap:wrap;
      color:var(--muted2);font-size:12px;
    }
    .badge{
      padding:4px 8px;border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      font-size:12px;
    }
    .badge.cat{border-color:rgba(255,204,0,.22); color: rgba(255,235,180,.95);}
    .badge.src{border-color:rgba(120,170,255,.25); color: rgba(200,220,255,.9);}

    .title{
      margin:0;
      font-size:18px;
      line-height:1.2;
      letter-spacing:.2px;
      display:-webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .summary{
      margin:0;
      color: var(--muted);
      line-height:1.45;
      font-size:14px;
      display:-webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }

    .actions{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-top:auto;
    }
    .btn-read{
      border:1px solid rgba(255,204,0,.28);
      background: rgba(255,204,0,.10);
      color: rgba(255,235,180,.98);
      padding:10px 12px;border-radius:14px;
      cursor:pointer;
      font-weight:700;
    }
    .btn-read:hover{background: rgba(255,204,0,.16)}
    .url{
      color:rgba(255,255,255,.35);
      font-size:12px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 240px;
    }

    /* Status */
    .status{
      margin: 8px 0 14px;
      color: var(--muted);
      font-size: 13px;
    }

    /* Modal */
    .hr-modal { position: fixed; inset: 0; display: none; z-index: 9999; }
    .hr-modal.is-open { display: block; }
    .hr-modal__backdrop { position: absolute; inset: 0; background: rgba(0,0,0,.55); }
    .hr-modal__panel {
      position: absolute; left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      width: min(920px, calc(100vw - 32px));
      max-height: min(86vh, 860px);
      overflow: auto;
      border-radius: 18px;
      background: #0f1623;
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.08);
    }
    .hr-modal__content { padding: 22px 22px 18px; }
    .hr-modal__close {
      position: sticky; top: 0; margin-left: auto; display: block;
      border: 0; background: transparent; color: #fff;
      font-size: 20px; padding: 14px 16px; cursor: pointer;
    }
    .hr-modal__meta { color: rgba(255,255,255,.65); font-size: 13px; margin-bottom: 10px; }
    .hr-modal__title { margin: 0 0 12px; font-size: 28px; line-height: 1.15; }
    .hr-modal__section h3 { margin: 14px 0 8px; font-size: 14px; color: rgba(255,255,255,.85); }
    .hr-modal__section p { margin: 0; color: rgba(255,255,255,.85); line-height: 1.6; white-space: pre-wrap; }
    .hr-modal__grid { display: grid; grid-template-columns: 1fr; gap: 14px; margin-top: 10px; }
    @media (min-width: 840px) { .hr-modal__grid { grid-template-columns: 1fr 1fr 1fr; } }
    .hr-modal__section ul { margin: 0; padding-left: 18px; color: rgba(255,255,255,.85); }
    .hr-modal__section li { margin: 0 0 8px; line-height: 1.5; }
    .hr-modal__actions { margin-top: 16px; display: flex; justify-content: space-between; gap: 10px; flex-wrap:wrap; }
    .hr-btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 10px 14px; border-radius: 12px;
      background: rgba(255,255,255,.08); color: #fff; text-decoration: none;
      border: 1px solid rgba(255,255,255,.12);
    }
    .hr-btn:hover { background: rgba(255,255,255,.12); }
    .hr-btn.secondary{background: rgba(255,204,0,.10); border-color: rgba(255,204,0,.25); color: rgba(255,235,180,.98);}

    /* Footer */
    .footer{
      margin-top:22px;
      padding-top:14px;
      border-top:1px solid rgba(255,255,255,.08);
      color: rgba(255,255,255,.45);
      font-size: 12px;
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;
    }
    .footer a{color: rgba(255,255,255,.60); text-decoration:none}
    .footer a:hover{text-decoration:underline}
  </style>
</head>

<body>
  <div class="container">
    <div class="topbar">
      <div class="brand">
        <div class="logo">HR</div>
        <div>
          <h1>Haber Robotu</h1>
          <div class="sub">CanlÄ± otomatik haber akÄ±ÅŸÄ±</div>
        </div>
      </div>

      <div class="searchwrap">
        <div class="search" title="BaÅŸlÄ±k/Ã¶zet iÃ§inde ara">
          <span style="color:rgba(255,255,255,.45)">ðŸ”Ž</span>
          <input id="q" type="text" placeholder="Haberlerde ara..." autocomplete="off" />
        </div>
      </div>

      <div class="pill" id="reloadBtn" title="Haberleri yenile">Yenile</div>
    </div>

    <div class="filters" id="filters"></div>

    <div class="status" id="status">YÃ¼kleniyor...</div>

    <div class="grid" id="news"></div>

    <div class="footer">
      <div>Â© <span id="yy"></span> Haber Robotu</div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <a href="about.html">HakkÄ±nda</a>
        <a href="privacy.html">Gizlilik</a>
        <a href="terms.html">KullanÄ±m ÅžartlarÄ±</a>
        <a href="contact.html">Ä°letiÅŸim</a>
      </div>
    </div>
  </div>

  <!-- Reader Modal -->
  <div id="readerModal" class="hr-modal" aria-hidden="true">
    <div class="hr-modal__backdrop" data-close="1"></div>

    <div class="hr-modal__panel" role="dialog" aria-modal="true" aria-label="Haber DetayÄ±">
      <button class="hr-modal__close" type="button" data-close="1">âœ•</button>

      <div class="hr-modal__content">
        <div class="hr-modal__meta" id="rmMeta"></div>
        <h1 class="hr-modal__title" id="rmTitle"></h1>

        <div class="hr-modal__section">
          <h3>Uzun Ã–zet</h3>
          <p id="rmLong"></p>
        </div>

        <div class="hr-modal__grid">
          <div class="hr-modal__section">
            <h3>Neden Ã¶nemli?</h3>
            <ul id="rmWhy"></ul>
          </div>

          <div class="hr-modal__section">
            <h3>Arka plan</h3>
            <ul id="rmBg"></ul>
          </div>

          <div class="hr-modal__section">
            <h3>OlasÄ± etkiler</h3>
            <ul id="rmImp"></ul>
          </div>
        </div>

        <div class="hr-modal__actions">
          <a id="rmSource" class="hr-btn secondary" href="#" target="_blank" rel="noopener noreferrer">
            KaynaÄŸa git
          </a>
          <button id="rmCopy" class="hr-btn" type="button">Linki kopyala</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const LATEST_JSON = "./news/latest.json";

    const CATEGORIES = ["Hepsi","TÃ¼rkiye","DÃ¼nya","Ekonomi","Teknoloji","Spor","SaÄŸlÄ±k"];

    const state = {
      articles: [],
      byId: {},
      category: "Hepsi",
      q: ""
    };

    function escText(s){ return (s ?? "").toString(); }

    function buildFilters(){
      const wrap = document.getElementById("filters");
      wrap.innerHTML = "";
      CATEGORIES.forEach(cat => {
        const b = document.createElement("div");
        b.className = "pill" + (cat === state.category ? " active" : "");
        b.textContent = cat;
        b.dataset.cat = cat;
        wrap.appendChild(b);
      });
    }

    function formatMeta(a){
      const src = a.source ? a.source : "Kaynak";
      const cats = (a.rss_categories && a.rss_categories.length) ? a.rss_categories.join(", ") : "";
      return {src, cats};
    }

    function pickTitle(a){
      return (a.title_tr && a.title_tr.trim()) ? a.title_tr : (a.title || "BaÅŸlÄ±k yok");
    }

    function pickSummary(a){
      const s = (a.summary_tr && a.summary_tr.trim()) ? a.summary_tr : (a.summary || "");
      return s;
    }

    function cardHTML(a){
      const meta = formatMeta(a);
      const catLabel = (a.rss_categories && a.rss_categories[0]) ? a.rss_categories[0] : "";
      const img = (a.image && a.image.trim()) ? `<img src="${a.image}" alt="">` : `<div class="noimg">GÃ¶rsel yok</div>`;
      const url = escText(a.url || "");
      return `
        <div class="card">
          <div class="thumb">${img}</div>

          <div class="cardbody">
            <div class="meta">
              <span class="badge src">${escText(meta.src)}</span>
              ${catLabel ? `<span class="badge cat">${escText(catLabel)}</span>` : ""}
            </div>

            <h2 class="title">${escText(pickTitle(a))}</h2>
            <p class="summary">${escText(pickSummary(a))}</p>

            <div class="actions">
              <button class="btn-read" type="button" data-open-reader="1" data-id="${escText(a.id)}">
                Haberi Oku
              </button>
              <div class="url" title="${url}">${url}</div>
            </div>
          </div>
        </div>
      `;
    }

    function applyFilters(){
      const q = state.q.trim().toLowerCase();
      const cat = state.category;

      return state.articles.filter(a => {
        const cats = (a.rss_categories || []);
        const catOk = (cat === "Hepsi") || cats.includes(cat);
        if (!catOk) return false;

        if (!q) return true;

        const hay = (pickTitle(a) + " " + pickSummary(a)).toLowerCase();
        return hay.includes(q);
      });
    }

    function render(){
      buildFilters();

      const list = applyFilters();
      const el = document.getElementById("news");
      el.innerHTML = list.map(cardHTML).join("");

      const st = document.getElementById("status");
      st.textContent = `GÃ¶sterilen: ${list.length} / Toplam: ${state.articles.length}`;
    }

    async function loadNews(){
      const st = document.getElementById("status");
      st.textContent = "Haberler yÃ¼kleniyor...";

      const res = await fetch(LATEST_JSON, {cache:"no-store"});
      if(!res.ok){
        st.textContent = `Hata: JSON alÄ±namadÄ± (HTTP ${res.status})`;
        return;
      }
      const data = await res.json();
      const list = Array.isArray(data.articles) ? data.articles : [];

      state.articles = list;

      state.byId = {};
      list.forEach(a => { if(a && a.id) state.byId[a.id] = a; });

      render();
    }

    // MODAL
    function fillList(ul, arr){
      ul.innerHTML = "";
      (arr || []).forEach(t => {
        const li = document.createElement("li");
        li.textContent = escText(t);
        ul.appendChild(li);
      });
    }

    function openReader(article){
      const modal = document.getElementById("readerModal");
      const rmMeta = document.getElementById("rmMeta");
      const rmTitle = document.getElementById("rmTitle");
      const rmLong = document.getElementById("rmLong");
      const rmWhy = document.getElementById("rmWhy");
      const rmBg = document.getElementById("rmBg");
      const rmImp = document.getElementById("rmImp");
      const rmSource = document.getElementById("rmSource");

      const title = pickTitle(article);
      rmTitle.textContent = title;

      const src = article.source ? `Kaynak: ${article.source}` : "";
      const cats = (article.rss_categories && article.rss_categories.length) ? ` â€¢ ${article.rss_categories.join(", ")}` : "";
      rmMeta.textContent = (src + cats).trim();

      rmLong.textContent =
        (article.summary_tr_long && article.summary_tr_long.trim())
          ? article.summary_tr_long
          : (article.summary_tr || article.summary || "");

      fillList(rmWhy, article.why_important);
      fillList(rmBg, article.background);
      fillList(rmImp, article.possible_impacts);

      rmSource.href = article.url || "#";

      modal.classList.add("is-open");
      modal.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function closeReader(){
      const modal = document.getElementById("readerModal");
      modal.classList.remove("is-open");
      modal.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }

    document.addEventListener("click", (e) => {
      const openBtn = e.target.closest("[data-open-reader='1']");
      if(openBtn){
        const id = openBtn.getAttribute("data-id");
        const a = state.byId[id];
        if(a) openReader(a);
        return;
      }
      const closeBtn = e.target.closest("[data-close='1']");
      if(closeBtn){
        closeReader();
        return;
      }

      const catBtn = e.target.closest("[data-cat]");
      if(catBtn){
        state.category = catBtn.dataset.cat;
        render();
        return;
      }
    });

    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape") closeReader();
    });

    document.getElementById("q").addEventListener("input", (e) => {
      state.q = e.target.value || "";
      render();
    });

    document.getElementById("reloadBtn").addEventListener("click", async () => {
      await loadNews();
    });

    document.getElementById("rmCopy").addEventListener("click", async () => {
      const a = document.getElementById("rmSource").href;
      try{
        await navigator.clipboard.writeText(a);
        document.getElementById("rmCopy").textContent = "KopyalandÄ±";
        setTimeout(() => (document.getElementById("rmCopy").textContent = "Linki kopyala"), 1200);
      }catch(_){
        alert("Kopyalama baÅŸarÄ±sÄ±z. Link: " + a);
      }
    });

    document.getElementById("yy").textContent = new Date().getFullYear();

    // Ä°lk yÃ¼kleme
    loadNews();
  </script>
</body>
</html>
