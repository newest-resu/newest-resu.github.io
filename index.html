<!doctype html>
<html lang="tr">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6477894031302669"
     crossorigin="anonymous"></script>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>Haber Robotu – Otomatik Güncel Haberler</title>
  <meta name="description" content="Türkiye ve dünyadan haberler, otomatik güncellenir. Başlık ve özetler bilgilendirme amaçlıdır." />

  <!-- AdSense (Publisher ID’yi gir) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX"
          crossorigin="anonymous"></script>

  <style>
    :root{
      --bg0:#070b14;
      --bg1:#0b1220;
      --card:#0e1a2f;
      --card2:#0c1527;
      --text:#e8eefc;
      --muted:#9bb0d5;
      --accent:#f5c542;
      --line:rgba(255,255,255,.08);
      --shadow: 0 16px 50px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 700px at 30% -10%, #172a52 0%, rgba(23,42,82,0) 60%),
                  radial-gradient(1000px 600px at 90% 10%, #1b3a6b 0%, rgba(27,58,107,0) 55%),
                  linear-gradient(180deg, var(--bg1), var(--bg0));
      min-height:100vh;
    }
    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width:1200px; margin:0 auto; padding:18px 14px 60px; }

    /* Layout with side ads */
    .grid{
      display:grid;
      grid-template-columns: 160px 1fr 160px;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 1060px){
      .grid{ grid-template-columns: 1fr; }
      .side{ display:none; }
    }

    .side{
      position:sticky;
      top:14px;
      padding-top:6px;
    }
    .adbox{
      background: rgba(255,255,255,.04);
      border:1px dashed rgba(255,255,255,.18);
      border-radius:14px;
      padding:10px;
      min-height:250px;
    }

    /* Header */
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:14px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .logo{
      width:54px; height:54px; border-radius:14px;
      background: var(--accent);
      color:#111;
      font-weight:900;
      display:grid; place-items:center;
      box-shadow: 0 10px 30px rgba(245,197,66,.22);
      flex:0 0 auto;
    }
    .brand h1{
      margin:0; font-size:28px; line-height:1.1;
      letter-spacing:.2px;
    }
    .brand p{ margin:4px 0 0; color:var(--muted); font-size:13px; }

    .navlinks{
      display:flex; flex-wrap:wrap; gap:10px;
      justify-content:flex-end;
    }
    .navlinks a{
      color:var(--muted);
      font-size:13px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
    }
    .navlinks a:hover{
      color:var(--text);
      border-color: rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
    }

    /* Top banner ad */
    .topAd{
      margin:10px 0 14px;
      border-radius:14px;
      overflow:hidden;
    }

    /* Controls */
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
    }
    .headlineRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .headlineRow h2{
      margin:0;
      font-size:16px;
      color:var(--text);
      letter-spacing:.2px;
    }
    .subnote{ color:var(--muted); font-size:12px; }

    .filters{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color:var(--text);
      font-size:13px;
      cursor:pointer;
      user-select:none;
      transition:.15s ease;
    }
    .pill:hover{ transform: translateY(-1px); }
    .pill.active{
      background: rgba(245,197,66,.14);
      border-color: rgba(245,197,66,.35);
      color: var(--text);
    }
    .spacer{ flex:1; }

    /* List */
    #status{
      margin:10px 0 0;
      color:var(--muted);
      font-size:13px;
    }
    .list{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
      margin-top:14px;
    }
    .card{
      display:flex;
      gap:14px;
      padding:14px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      box-shadow: 0 12px 40px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .thumb{
      width:112px;
      height:84px;
      border-radius:14px;
      overflow:hidden;
      background: rgba(0,0,0,.2);
      flex:0 0 auto;
      display:grid;
      place-items:center;
      border:1px solid rgba(255,255,255,.08);
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .thumb .noimg{ color:rgba(255,255,255,.35); font-size:12px; }

    .body{ min-width:0; flex:1; }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      margin-bottom:8px;
    }
    .badge{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--muted);
    }
    .badge.source{ color:#d9e4ff; }
    .badge.cat{ color:#b8c8f1; }
    .badge.tag{
      color: #111;
      background: rgba(245,197,66,.95);
      border-color: rgba(245,197,66,1);
      font-weight:700;
    }

    .title{
      margin:0;
      font-size:18px;
      line-height:1.25;
      letter-spacing:.1px;
      word-break:break-word;
    }
    .summary{
      margin:8px 0 0;
      color:rgba(232,238,252,.78);
      font-size:14px;
      line-height:1.45;
      word-break:break-word;
    }
    .actions{
      display:flex;
      align-items:center;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color: var(--text);
      font-size:13px;
      cursor:pointer;
      user-select:none;
      transition:.15s ease;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.22); }
    .btn.primary{
      border-color: rgba(245,197,66,.45);
      background: rgba(245,197,66,.14);
    }
    .url{
      color: rgba(232,238,252,.45);
      font-size:12px;
      max-width:420px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    /* Inline ad between cards */
    .inlineAd{
      border-radius: var(--radius);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.02);
      padding:10px;
    }

    /* Footer */
    footer{
      margin-top:16px;
      color:rgba(232,238,252,.55);
      font-size:12px;
      line-height:1.5;
    }

    /* Modal */
    .modalBackdrop{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.58);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:9999;
    }
    .modalBackdrop.open{ display:flex; }
    .modal{
      width:min(980px, 100%);
      max-height: min(86vh, 780px);
      overflow:auto;
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(16,28,52,.98), rgba(10,17,32,.98));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 25px 90px rgba(0,0,0,.55);
      padding:18px;
    }
    .modalTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .modal h3{
      margin:0;
      font-size:22px;
      line-height:1.25;
    }
    .modal .small{
      color:var(--muted);
      font-size:12px;
      margin-top:6px;
    }
    .close{
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      cursor:pointer;
      color:var(--text);
      user-select:none;
    }
    .modalBody{
      margin-top:14px;
      display:grid;
      gap:12px;
    }
    .section{
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding:14px;
    }
    .section h4{
      margin:0 0 10px;
      color:rgba(232,238,252,.92);
      font-size:14px;
      letter-spacing:.2px;
    }
    .section p{
      margin:0;
      color:rgba(232,238,252,.78);
      font-size:14px;
      line-height:1.55;
      white-space:pre-wrap;
      word-break:break-word;
    }
    .bullets{
      margin:0;
      padding-left:18px;
      color:rgba(232,238,252,.78);
      font-size:14px;
      line-height:1.55;
    }
    .modalActions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="grid">
      <!-- LEFT SIDE AD -->
      <aside class="side">
        <div class="adbox">
          <!-- Sol Skyscraper (160x600 / 300x600) -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-XXXXXXXXXXXX"
               data-ad-slot="1111111111"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
      </aside>

      <!-- MAIN -->
      <main>
        <header>
          <div class="brand">
            <div class="logo">HR</div>
            <div>
              <h1>Haber Robotu</h1>
              <p>Türkiye ve dünyadan haberler, otomatik güncellenir.</p>
            </div>
          </div>

          <nav class="navlinks">
            <a href="/about.html">Hakkında</a>
            <a href="/privacy.html">Gizlilik Politikası</a>
            <a href="/terms.html">Kullanım Şartları</a>
            <a href="/contact.html">İletişim</a>
          </nav>
        </header>

        <!-- TOP BANNER AD -->
        <div class="topAd">
          <div class="adbox" style="min-height:110px;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXX"
                 data-ad-slot="2222222222"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
          </div>
        </div>

        <section class="panel">
          <div class="headlineRow">
            <div>
              <h2>Canlı otomatik haber akışı</h2>
              <div class="subnote">Başlık/özet Türkçe gösterilir. Detayda “uzun özet + çıkarımlar” açılır.</div>
            </div>
          </div>

          <div class="filters" id="sourceFilters"></div>
          <div class="filters" id="categoryFilters" style="margin-top:8px;"></div>

          <div id="status">Haberler yükleniyor…</div>
          <div class="list" id="newsList"></div>

          <footer>
            İçerikler ilgili haber sitelerinden otomatik olarak derlenir. Başlık ve özetler bilgilendirme amaçlıdır.
            Detaylar için her haberde “Kaynağa Git” bağlantısını kullanabilirsiniz.
          </footer>
        </section>
      </main>

      <!-- RIGHT SIDE AD -->
      <aside class="side">
        <div class="adbox">
          <!-- Sağ Skyscraper -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-XXXXXXXXXXXX"
               data-ad-slot="3333333333"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
      </aside>
    </div>
  </div>

  <!-- MODAL -->
  <div class="modalBackdrop" id="modalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalTop">
        <div>
          <h3 id="modalTitle">Haber</h3>
          <div class="small" id="modalMeta"></div>
        </div>
        <div class="close" id="modalClose">Kapat</div>
      </div>

      <div class="modalBody">
        <div class="section">
          <h4>Uzun Özet</h4>
          <p id="modalLong"></p>
        </div>

        <div class="section">
          <h4>Neden Önemli?</h4>
          <ul class="bullets" id="modalWhy"></ul>
        </div>

        <div class="section">
          <h4>Arka Plan</h4>
          <ul class="bullets" id="modalBg"></ul>
        </div>

        <div class="section">
          <h4>Olası Etkiler</h4>
          <ul class="bullets" id="modalImp"></ul>
        </div>

        <div class="modalActions">
          <a class="btn primary" id="modalSource" target="_blank" rel="noopener noreferrer">Kaynağa Git</a>
          <div class="btn" id="modalCopy">Linki Kopyala</div>
        </div>

        <!-- Modal içinde de istersen küçük bir reklam alanı -->
        <div class="section" style="padding:10px;">
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-XXXXXXXXXXXX"
               data-ad-slot="4444444444"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
      </div>
    </div>
  </div>

  <script>
    const LATEST_URL = "/news/latest.json"; // GitHub Pages aynı domainde

    let ALL = [];
    let sourceActive = "Tümü";
    let typeActive = "Tümü";
    let categoryActive = "Tümü";

    function safeText(v){ return (v ?? "").toString().trim(); }

    function getDomain(url){
      try{ return new URL(url).hostname.replace(/^www\./,''); }catch(_){ return ""; }
    }

    function classifySource(article){
      const d = getDomain(article.url || "");
      const isTr = d.endsWith(".tr");
      return { label: article.source || d || "Kaynak", type: isTr ? "tr" : "intl" };
    }

    function categoriesOf(article){
      const cats = Array.isArray(article.rss_categories) ? article.rss_categories : [];
      return cats.map(c => safeText(c)).filter(Boolean);
    }

    function uniq(arr){
      return [...new Set(arr)];
    }

    function el(tag, attrs={}, html=""){
      const x = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v]) => x.setAttribute(k, v));
      if(html) x.innerHTML = html;
      return x;
    }

    function renderFilters(){
      const srcWrap = document.getElementById("sourceFilters");
      const catWrap = document.getElementById("categoryFilters");
      srcWrap.innerHTML = "";
      catWrap.innerHTML = "";

      const sources = uniq(["Tümü", ...ALL.map(a => (a.source || "Kaynak"))]);
      const types = ["Tümü", "Türkiye Kaynaklı", "Yabancı Kaynaklı"];
      const categories = uniq(["Tümü", ...ALL.flatMap(a => categoriesOf(a))]);

      function pill(text, active, onClick){
        const p = el("div", { class: "pill" + (active ? " active" : "") });
        p.textContent = text;
        p.addEventListener("click", onClick);
        return p;
      }

      sources.forEach(s => srcWrap.appendChild(
        pill(s, sourceActive===s, () => { sourceActive=s; renderList(); renderFilters(); })
      ));

      types.forEach(t => srcWrap.appendChild(
        pill(t, typeActive===t, () => { typeActive=t; renderList(); renderFilters(); })
      ));

      categories.forEach(c => catWrap.appendChild(
        pill(c, categoryActive===c, () => { categoryActive=c; renderList(); renderFilters(); })
      ));
    }

    function filterList(){
      return ALL.filter(a => {
        const src = (a.source || "Kaynak");
        const csrc = classifySource(a);
        const cats = categoriesOf(a);

        if(sourceActive !== "Tümü" && src !== sourceActive) return false;
        if(typeActive === "Türkiye Kaynaklı" && csrc.type !== "tr") return false;
        if(typeActive === "Yabancı Kaynaklı" && csrc.type !== "intl") return false;

        if(categoryActive !== "Tümü"){
          if(!cats.includes(categoryActive)) return false;
        }
        return true;
      });
    }

    function makeInlineAd(){
      const box = el("div", { class:"inlineAd" });
      box.innerHTML = `
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXX"
             data-ad-slot="5555555555"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      `;
      // push after inserted
      setTimeout(() => { try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){} }, 0);
      return box;
    }

    function renderList(){
      const list = document.getElementById("newsList");
      const status = document.getElementById("status");
      const items = filterList();

      status.textContent = items.length ? `Gösterilen haber: ${items.length}` : "Bu filtrelerle haber bulunamadı.";
      list.innerHTML = "";

      items.forEach((a, idx) => {
        const csrc = classifySource(a);
        const cats = categoriesOf(a);
        const catLabel = cats[0] || "Genel";

        const title = safeText(a.title_tr) || safeText(a.title) || "Başlık yok";
        const summary = safeText(a.summary_tr) || safeText(a.summary) || "";

        const card = el("div", { class:"card" });

        const thumb = el("div", { class:"thumb" });
        const imgUrl = safeText(a.image);
        if(imgUrl){
          const img = new Image();
          img.src = imgUrl;
          img.alt = title;
          img.loading = "lazy";
          img.referrerPolicy = "no-referrer";
          img.onerror = () => { thumb.innerHTML = '<div class="noimg">Görsel yok</div>'; };
          thumb.appendChild(img);
        }else{
          thumb.innerHTML = '<div class="noimg">Görsel yok</div>';
        }

        const body = el("div", { class:"body" });

        const meta = el("div", { class:"meta" });
        meta.appendChild(el("span", { class:"badge source" }, csrc.label));
        meta.appendChild(el("span", { class:"badge tag" }, csrc.type==="tr" ? "Türkiye kaynağı" : "Uluslararası kaynak"));
        meta.appendChild(el("span", { class:"badge cat" }, catLabel));

        const h = el("h3", { class:"title" });
        h.textContent = title;

        const p = el("p", { class:"summary" });
        p.textContent = summary;

        const actions = el("div", { class:"actions" });

        const openBtn = el("div", { class:"btn primary" });
        openBtn.textContent = "Haberi Oku";
        openBtn.addEventListener("click", () => openModal(a));

        const sourceBtn = el("a", { class:"btn", href: a.url, target:"_blank", rel:"noopener noreferrer" });
        sourceBtn.textContent = "Kaynağa Git";

        const url = el("div", { class:"url" });
        url.textContent = a.url || "";

        actions.appendChild(openBtn);
        actions.appendChild(sourceBtn);
        actions.appendChild(url);

        body.appendChild(meta);
        body.appendChild(h);
        body.appendChild(p);
        body.appendChild(actions);

        card.appendChild(thumb);
        card.appendChild(body);

        list.appendChild(card);

        // every 6 items -> inline ad
        if((idx+1) % 6 === 0){
          list.appendChild(makeInlineAd());
        }
      });
    }

    // Modal
    const backdrop = document.getElementById("modalBackdrop");
    const modalClose = document.getElementById("modalClose");

    function setBullets(id, arr){
      const ul = document.getElementById(id);
      ul.innerHTML = "";
      (Array.isArray(arr) ? arr : []).forEach(t => {
        const li = document.createElement("li");
        li.textContent = safeText(t);
        ul.appendChild(li);
      });
      if(!ul.children.length){
        const li = document.createElement("li");
        li.textContent = "—";
        ul.appendChild(li);
      }
    }

    function openModal(a){
      document.getElementById("modalTitle").textContent =
        safeText(a.title_tr) || safeText(a.title) || "Haber";

      const meta = `${safeText(a.source) || "Kaynak"} • ${categoriesOf(a)[0] || "Genel"} • ${getDomain(a.url || "")}`;
      document.getElementById("modalMeta").textContent = meta;

      document.getElementById("modalLong").textContent =
        safeText(a.summary_tr_long) || safeText(a.summary_tr) || safeText(a.summary) || "";

      setBullets("modalWhy", a.why_important);
      setBullets("modalBg", a.background);
      setBullets("modalImp", a.possible_impacts);

      const source = document.getElementById("modalSource");
      source.href = a.url || "#";

      const copyBtn = document.getElementById("modalCopy");
      copyBtn.onclick = async () => {
        try{
          await navigator.clipboard.writeText(a.url || "");
          copyBtn.textContent = "Kopyalandı";
          setTimeout(()=> copyBtn.textContent="Linki Kopyala", 1200);
        }catch(_){
          copyBtn.textContent = "Kopyalanamadı";
          setTimeout(()=> copyBtn.textContent="Linki Kopyala", 1200);
        }
      };

      backdrop.classList.add("open");
      backdrop.setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
    }

    function closeModal(){
      backdrop.classList.remove("open");
      backdrop.setAttribute("aria-hidden","true");
      document.body.style.overflow = "";
    }

    modalClose.addEventListener("click", closeModal);
    backdrop.addEventListener("click", (e) => { if(e.target === backdrop) closeModal(); });
    document.addEventListener("keydown", (e) => { if(e.key === "Escape") closeModal(); });

    async function loadNews(){
      const status = document.getElementById("status");
      try{
        status.textContent = "Haberler yükleniyor…";
        const res = await fetch(LATEST_URL + "?t=" + Date.now(), { cache:"no-store" });
        if(!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();
        ALL = Array.isArray(data.articles) ? data.articles : [];
        renderFilters();
        renderList();
      }catch(err){
        status.textContent = "Hata: " + (err?.message || err);
      }
    }

    loadNews();
  </script>
</body>
</html>
