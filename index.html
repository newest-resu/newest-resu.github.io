<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Haber Robotu – Otomatik Güncel Haberler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Açıklama & Open Graph -->
  <meta name="description" content="Türkiye ve dünyadan en güncel haberler, her saat otomatik yenilenen akışla tek sayfada.">
  <meta property="og:title" content="Haber Robotu – Otomatik Güncel Haberler">
  <meta property="og:description" content="Türkiye ve dünyadan en güncel haberler, her saat otomatik yenilenen akışla tek sayfada.">
  <meta property="og:url" content="https://newest-resu.github.io/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Haber Robotu">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Google AdSense (Auto Ads) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6477894031302669" crossorigin="anonymous"></script>

  <style>
    /* Temel stilleme (senin orijinalinden) */
    body { margin:0; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background:#0f172a; color:#e5e7eb; }
    .shell{ max-width:1100px; margin:0 auto; padding:16px 12px 48px; }
    header{ display:flex; align-items:center; gap:12px; padding:16px 18px; background:rgba(15,23,42,.98); border-radius:12px; }
    header .title{ font-size:20px; font-weight:700; }
    .toolbar{ display:flex; gap:12px; flex-wrap:wrap; }
    .btn-filter{ cursor:pointer; padding:6px 10px; border-radius:999px; background:#1f2937; border:1px solid #374151; color:#e5e7eb; font-size:13px; }
    .btn-filter.active{ background:#facc15; color:#0f172a; border-color:#facc15; }

    #haberler{ margin-top:14px; display:flex; flex-direction:column; gap:12px; }
    .card{ background:rgba(15,23,42,0.96); padding:12px; border-radius:12px; border:1px solid rgba(31,41,55,0.9); }
    .headline{ font-size:16px; font-weight:700; margin:6px 0; color:#f9fafb; }
    .summary{ font-size:13px; color:#d1d5db; }

    .modal-backdrop{ position:fixed; inset:0; background:rgba(2,6,23,.75); display:none; align-items:center; justify-content:center; }
    .modal-backdrop.open{ display:flex; }
    .modal{ background:#111827; border-radius:12px; padding:16px; width:min(90%,680px); }
    .modal-title{ font-size:18px; font-weight:800; }
    .modal-content{ margin-top:8px; font-size:14px; color:#d1d5db; }

  </style>
</head>
<body>

  <div class="shell">
    <header>
      <div class="title">Haber Robotu</div>
      <div style="flex:1"></div>
      <button class="btn-filter" id="btnManualRefresh">Yenile</button>
    </header>

    <!-- Kaynak & Kategori Filtre -->
    <div class="toolbar">
      <button class="btn-filter btn-filter-source active" data-filter-source="all">Tüm Kaynaklar</button>
      <button class="btn-filter btn-filter-source" data-filter-source="tr">Türkiye Kaynaklı</button>
      <button class="btn-filter btn-filter-source" data-filter-source="intl">Yabancı Kaynaklı</button>
    </div>
    <div class="toolbar">
      <button class="btn-filter btn-filter-cat active" data-filter-cat="all">Tüm Kategoriler</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="yerel">Yerel</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="gundem">Gündem</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="dunya">Dünya</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="spor">Spor</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="teknoloji">Teknoloji</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="saglik">Sağlık</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="ekonomi">Ekonomi</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="finans">Finans</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="magazin">Magazin</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="bilim">Bilim</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="savunma">Savunma / Askeri</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="oyun">Oyun / Dijital</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="otomobil">Otomobil</button>
      <button class="btn-filter btn-filter-cat" data-filter-cat="yasam">Yaşam</button>
    </div>

    <div id="status"></div>
    <div id="haberler"></div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal">
      <div class="modal-title" id="modalTitle"></div>
      <div class="modal-content" id="modalContent"></div>
    </div>
  </div>

  <script>
let ALL_ARTICLES = [];
let CURRENT_CATEGORY = "all";
const AUTO_REFRESH_MS = 60 * 60 * 1000;

async function loadNews(manual=false) {
  const res = await fetch("news/latest.json?ts=" + Date.now());
  const data = await res.json();

  if (manual && data.updated_at === window.lastUpdate) return;

  window.lastUpdate = data.updated_at;
  ALL_ARTICLES = data.articles || [];
  document.getElementById("lastUpdate").innerText =
    "Son güncelleme: " + new Date(data.updated_at).toLocaleString("tr-TR");

  render();
}

function render() {
  const list = document.getElementById("newsList");
  list.innerHTML = "";

  ALL_ARTICLES
    .filter(a => CURRENT_CATEGORY === "all" || a.category === CURRENT_CATEGORY)
    .forEach(a => {
      const div = document.createElement("div");
      div.className = "news-card";
      div.innerHTML = `
        <h3>${a.title}</h3>
        <p>${a.source} • ${a.category.toUpperCase()}</p>
        <button onclick="openModal('${a.title}','${a.url}','${a.source}')">
          Haberi Oku
        </button>
      `;
      list.appendChild(div);
    });
}

function openModal(title,url,source){
  const m=document.getElementById("modal");
  m.querySelector("h2").innerText=title;
  m.querySelector("p").innerText=
    "Bu haber, " + source +
    " tarafından yayımlanmıştır. Kaynağa giderek tamamını okuyabilirsiniz.";
  m.querySelector("a").href=url;
  m.style.display="block";
}

function closeModal(){
  document.getElementById("modal").style.display="none";
}

document.querySelectorAll("[data-category]").forEach(b=>{
  b.onclick=()=>{CURRENT_CATEGORY=b.dataset.category;render();}
});

document.getElementById("manualRefresh").onclick=()=>loadNews(true);

loadNews();
setInterval(loadNews, AUTO_REFRESH_MS);
</script>
</body>
</html>
